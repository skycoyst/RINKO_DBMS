# 📊 AAQ-RINKO CSV 仕分け・結合ツール

観測データの自動仕分け・統合・水深区分別平均値計算ツール

**バージョン：** 3.2
**最終更新：** 2026年2月

---

## 🌟 概要

AAQ-RINKO CSV 仕分け・結合ツールは、複数の観測データCSVファイルを以下の方法で効率的に処理するWebアプリケーションです：

- 📍 **自動仕分け** - ファイル名から地点を自動判定し、該当する「スイムレーン」に分類
- 🔄 **カンバン形式UI** - 地点ごとのスイムレーンを視覚的に管理、ドラッグ&ドロップで移動可能
- 🗺️ **地図ベース座標管理** - 地点の緯度経度を地図上でピンをドラッグして直感的に設定
- 📊 **複数フォーマット出力** - 生データ統合（形式A）または水深区分別平均値計算（形式B）
- 🌊 **水深区分処理** - 自動的に深度を0.5m単位で区分し、B-1mフラグを付与

---

## 🚀 クイックスタート

### オンライン版（推奨）
GitHub Pages でホストされているバージョンをブラウザで開いてください：

```
https://{username}.github.io/aaq-rinko-tool/
```

### ローカル版
1. このリポジトリをクローン
```bash
git clone https://github.com/{username}/aaq-rinko-tool.git
cd aaq-rinko-tool
```

2. `index.html` をブラウザで開く
```bash
# Windows
start index.html

# macOS
open index.html

# Linux
xdg-open index.html
```

---

## 📋 必要な環境

### サポートブラウザ
- ✅ **Chrome/Chromium** 90 以上
- ✅ **Firefox** 88 以上
- ✅ **Safari** 14 以上
- ✅ **Edge** 90 以上
- ❌ **Internet Explorer** (非対応)

### 推奨環境
- **OS**: Windows 10/11, macOS 10.14+, Linux
- **メモリ**: 4GB 以上
- **インターネット**: 地図タイルの読み込みのため必要

---

## 🔒 プライバシー＆セキュリティ

### ✅ すべての処理はブラウザで実行されます

**データは一切サーバーに送信されません。**

- 🖴 アップロードしたCSVファイルはブラウザメモリのみで処理
- 🖴 ローカルストレージへの保存なし
- 🖴 外部サーバーへのデータ送信なし
- 🖴 Cookie による追跡なし

詳細は [PRIVACY.md](./PRIVACY.md) をご参照ください。

---

## 📖 ドキュメント

- **[manual.html](./manual.html)** - 完全なユーザーマニュアル（PDF出力可能）
- **[PRIVACY.md](./PRIVACY.md)** - プライバシーポリシー
- **[LICENSE](./LICENSE)** - MIT ライセンス

---

## 📁 ファイル構成

```
aaq-rinko-tool/
├── index.html              # メインHTML
├── manual.html             # ユーザーマニュアル
├── README.md               # このファイル
├── PRIVACY.md              # プライバシーポリシー
├── LICENSE                 # MITライセンス
├── js/
│   ├── app.js              # メインアプリロジック
│   ├── uiController.js     # UI制御
│   ├── mapController.js    # 地図制御（Leaflet.js）
│   ├── fileHandler.js      # CSV解析
│   └── dataProcessor.js    # データ処理・集計
├── css/
│   └── custom.css          # カスタムスタイル
├── assets/
│   └── sample_master.csv   # サンプルマスタCSV
└── .github/workflows/
    └── deploy.yml          # GitHub Pages自動デプロイ
```

---

## 🎯 主な機能

### 1. 地点マスタ管理
- CSV形式での一括読み込み
- 地点ID、地点名、座標、キーワード管理
- テンプレート列による一括スイムレーン化
- 地点の追加・編集・削除

### 2. 観測データ処理
- Shift_JIS/UTF-8 自動判定
- 複数ファイル一括読み込み
- GPS座標の自動抽出（NMEA形式対応）
- 同名同日時ファイルの上書き確認

### 3. 自動仕分け
- **英数字キーワード** → スペース区切り完全単語一致
- **日本語キーワード** → 部分一致
- スイムレーン地点のみを対象

### 4. スイムレーン管理
- カンバン形式の視覚的管理
- ドラッグ&ドロップでカード移動
- 個別・テンプレート・全一括追加
- スイムレーン解除・リセット機能

### 5. 地図ベース座標設定
- Leaflet.js による地図表示
- ピンをドラッグして座標を取得
- 複数背景地図（写真・淡色地図）
- 地図上での地点追加

### 6. CSV出力
- **形式A** - 生データ統合
- **形式B** - 水深区分別平均値計算
- UTF-8 BOM 付き出力
- 未分類・警告ファイルの確認ダイアログ

---

## ⚠️ 利用上の注意

### メモリ制限
- 複数ファイル読み込みは **50個程度** を推奨
- 大容量ファイル（1GB超）は分割してください
- メモリ不足時は他のタブを閉じてください

### ファイルフォーマット
- **エンコーディング** - Shift_JIS または UTF-8（BOM対応）
- **改行コード** - CRLF/LF 自動判定
- **CSV形式** - ダブルクォート標準準拠

### GPS座標
- **フォーマット** - 十進数（度・分・秒から自動変換）
- **精度** - 小数4〜7桁（±11m 〜 ±1cm）
- **範囲** - 緯度 -90〜90°、経度 -180〜180°

### 地理院地図
- 公開利用可能なタイル
- 利用規約に従いご使用ください
- 詳細は [地理院地図](https://maps.gsi.go.jp) をご参照

---

## 🤝 サポート・フィードバック

問題が発生した場合や機能リクエストがあれば、以下の方法でお知らせください：

1. **GitHub Issues** - バグ報告・機能リクエスト
2. **Discussions** - 使い方の質問・相談
3. **Pull Requests** - 改善提案・コード貢献

---

## 📝 ライセンス

このプロジェクトは **MIT License** の下で公開されています。

詳細は [LICENSE](./LICENSE) ファイルをご参照ください。

---

## 🔄 バージョン履歴

### v3.2 (2026-02-27)
- ✨ 地図でピンをドラッグして座標を取得する機能を追加
- ✨ テンプレート列による一括スイムレーン化を実装
- ✨ スイムレーン手動管理（自動作成廃止）
- 🐛 英数字キーワードの完全単語一致に対応
- 📚 完全なユーザーマニュアルを作成

### v3.1
- 🔧 スイムレーン自動リセット機能改善
- 🔧 再分類ボタンの表示・非表示制御

### v3.0
- 🎉 v3系リリース（カンバン形式UI導入）

---

## 📞 お問い合わせ

ご質問やご意見は、GitHub Issues またはメールでお願いします。

---

**Made with ❤️ for data scientists and water resource researchers**
